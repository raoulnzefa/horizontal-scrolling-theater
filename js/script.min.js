let vm=new Vue({el:"#app",data:{movies:[],cart:[],currentMovie:null,cartOpen:!1,cartIcon:"cart-outline",addingToCartBlock:!1,arrowLeftShow:!1},created(){axios.get("https://raw.githubusercontent.com/raychang2017/f2e-portfolio/master/13%20-%20%E7%94%A8%20Vue%20%E5%92%8C%20API%20%E5%81%9A%E4%B8%80%E5%80%8B%E6%A9%AB%E5%90%91%E6%8D%B2%E5%8B%95%E9%9B%BB%E5%BD%B1%E8%B3%BC%E7%89%A9%E9%A0%81%E9%9D%A2/data/movie.json").then(res=>{this.movies=res.data,console.log(`電影總計 ${this.movies.length} 部`)}).catch(err=>{console.log(err)})},methods:{getBackgroundSetting:url=>({"background-image":`url(${url})`,"background-position":"center center","background-size":"cover"}),scroll(e){TweenMax.to(".cards",.6,{left:"+="+1.5*e.deltaY+"px"}),this.showOrHideLeftArrow(),this.backToTopOrLast()},showOrHideLeftArrow(){const cardsElLeft=document.querySelector(".cards").style.left.replace("px","");if(cardsElLeft<-800)return this.arrowLeftShow=!0;this.arrowLeftShow=!1},backToTopOrLast(){const cardsEl=document.querySelector(".cards"),cardsElLeft=cardsEl.style.left.replace("px",""),scrollProgress=Math.round(-cardsElLeft/cardsEl.scrollWidth*100)/100*100+"%";cardsElLeft>0&&TweenMax.to(".cards",.6,{left:0}),cardsElLeft<585-cardsEl.scrollWidth&&TweenMax.to(".cards",.6,{left:585-cardsEl.scrollWidth})},moveToTop(){TweenMax.to(".cards",.6,{left:0}),setTimeout(()=>{this.showOrHideLeftArrow()},500)},cartToggle(){this.cartOpen=!this.cartOpen,this.cartOpen?(this.cartIcon="cart",this.arrowLeftShow=!1):(this.cartIcon="cart-outline",this.arrowLeftShow=!0)},addToCart(movie,e){this.addingToCartBlock||(this.addingToCartBlock=!0,this.currentMovie=movie,this.$nextTick(()=>{TweenMax.from(".moving-cover",.8,{left:$(e.target).offset().left,top:$(e.target).offset().top,opacity:1,ease:Power1.easeOut}),setTimeout(()=>{this.cart.push(movie)},600),setTimeout(()=>{this.addingToCartBlock=!1},1e3)}))},truncate:(str,maxLength)=>str.length>maxLength?str.slice(0,maxLength-1)+" ...":str,thousandFormat:num=>((num+="").includes(".")||(num+="."),num.replace(/(\d)(?=(\d{3})+\.)/g,(function($0,$1){return $1+","})).replace(/\.$/,"")),organizeDataDuplicatedObject(){}},computed:{totalPrice(){return this.cart.map(movie=>movie.price).reduce((total,current)=>total+current,0)}},watch:{cart(){TweenMax.from(".cart-icon",.3,{scale:.8})}}});